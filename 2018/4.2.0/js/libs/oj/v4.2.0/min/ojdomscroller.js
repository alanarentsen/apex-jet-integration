/**
 * Copyright (c) 2014, 2018, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery"],function(a,g){a.di=function(a,b,d){d=d||{};this.p=b;this.mn=d.asyncIterator;this.Zk=g(a)[0];this.NR=d.fetchSize;this.NR=0<this.NR?this.NR:25;this.QE=d.maxCount;this.QE=0<this.QE?this.QE:500;this.Ju=0<d.initialRowCount?d.initialRowCount:0;this.aua=d.success;this.asa=d.request;this.LR=d.error;this.bB();this.uo=d.fetchTrigger;if(null==this.uo||isNaN(this.uo))this.uo=0;this.bTa=this.Zk.scrollTop;g(this.ES()).on("scroll.domscroller",function(){var a=this.Zk,b=this.zPa(a),
a=a.scrollHeight-a.clientHeight;0<a&&this.h5(b,a)}.bind(this))};a.di.prototype.L6a=function(a){null!=a&&!isNaN(a)&&0<=a&&(this.uo=a)};a.di.prototype.ES=function(){return this.Zk==document.body||this.Zk==document.documentElement?window:this.Zk};a.di.X0a=function(a,b){for(var d=0,e=b;e&&e!=a&&g.contains(a,e);)d+=e.offsetTop,e=e.offsetParent;return d};a.di.prototype.zPa=function(a){var b=this.uo;return a==document.documentElement&&(void 0===this.Wua&&(this.Wua=this.bTa==a.scrollTop?!0:!1),this.Wua)?
b+document.body.scrollTop:b+a.scrollTop};a.di.prototype.destroy=function(){this.dq();g(this.ES()).off("scroll.domscroller")};a.f.j("DomScroller.prototype.destroy",{destroy:a.di.prototype.destroy});a.di.prototype.checkViewport=function(){return this.mn&&0<this.Zk.clientHeight&&!this.EJa()?this.Nka():Promise.resolve(null)};a.f.j("DomScroller.prototype.checkViewport",{checkViewport:a.di.prototype.checkViewport});a.di.prototype.h5=function(a,b){if(1>=b-a&&a>this.uo&&!this.IJ)if(this.mn){var d=this;this.Nka().then(function(a){d.aua&&
d.aua(a)},function(a){d.LR&&d.LR(a)})}else null!=this.LR&&this.LR()};a.di.prototype.EJa=function(){var a=this.Zk;return a.scrollHeight>a.clientHeight+this.uo?!0:!1};a.di.prototype.Nka=function(){if(this.IJ)return this.IJ;var a=this.QE-this.Ju;if(0<a){var b=this;if(this.mn)return null!=this.asa&&this.asa(),this.IJ=this.mn.next().then(function(d){b.IJ=null;null!=d&&null!=d.value&&(0<d.value.data.length&&(b.Ju+=d.value.data.length,a<b.NR&&(d.maxCount=b.QE,d.maxCountLimit=!0,d.value.data.length>a&&(d.value.data=
d.value.data.slice(0,a),d.value.metadata=d.value.metadata.slice(0,a),null!=d.value.fetchParameters&&(d.value.fetchParameters.size=a)))),d.done&&(b.mn=null));return Promise.resolve(d)})}return Promise.resolve({maxCount:this.QE,maxCountLimit:!0})};a.di.prototype.BQa=function(a){var b=null,d=null;null!=a.detail.remove&&(b="remove",d=a.detail.remove);null!=a.detail.add&&(b="add",d=a.detail.add);if(null!=b){a=d.indexes;for(var e=a.length,d=0;d<e;d++){var f=a[d];void 0!==f&&0<this.Ju&&f<=this.Ju&&("add"==
b?this.Ju+=1:"remove"==b&&(this.Ju-=1))}}};a.di.prototype.bB=function(){var a=this.p;if(null!=a){this.dq();this.lh=[];this.lh.push({eventType:"mutate",eventHandler:this.BQa.bind(this)});var b,d;for(b=0;b<this.lh.length;b++)(d=a.addEventListener(this.lh[b].eventType,this.lh[b].eventHandler))&&(this.lh[b].eventHandler=d)}};a.di.prototype.dq=function(){var a=this.p;if(null!=this.lh&&null!=a){var b;for(b=0;b<this.lh.length;b++)a.removeEventListener(this.lh[b].eventType,this.lh[b].eventHandler)}}});