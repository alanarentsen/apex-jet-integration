/**
 * Copyright (c) 2014, 2018, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","ojs/ojeventtarget","ojs/ojdataprovider"],function(a){var g=function(){function c(b){this.ue=b;this.bj="key";this.Nc="keys";this.TZ="afterKeys";this.jD="direction";this.vI="startIndex";this.eD="attribute";this.LGa="silent";this.eQ="sort";this.qf="sortCriteria";this.Q_="pageSize";this.ec="data";this.Af="metadata";this.hw="indexes";this.Jh="offset";this.a0="refresh";this.oi="size";this.Nj="value";this.Zm="done";this.$m="fetchParameters";this.aI="containsParameters";this.jn=
"results";this.SZ="add";this.b0="remove";this.z0="update";this.cfa="fetchType";this.Mv=function(){return function(b,a){this.mc=b;this.mn=a;this[Symbol.asyncIterator]=function(){return this.mn}}}();this.Nv=function(){function b(a,c,d){this.mc=a;this.kL=c;this.nL=d;this.Lka=!0}b.prototype.next=function(){var b=this.Lka;this.Lka=!1;return this.kL(this.nL,b)};return b}();this.Ov=function(){return function(b,a,c){this.mc=b;this.value=a;this.done=c;this[b.Nj]=a;this[b.Zm]=c}}();this.IC=function(){return function(b,
a,c){this.mc=b;this.fetchParameters=a;this.results=c;this[b.$m]=a;this[b.jn]=c}}();this.rH=function(){return function(b,a,c){this.mc=b;this.containsParameters=a;this.results=c;this[b.aI]=a;this[b.jn]=c}}();this.Sv=function(){return function(b,a,c,h){this.mc=b;this.fetchParameters=a;this.data=c;this.metadata=h;this[b.$m]=a;this[b.ec]=c;this[b.Af]=h}}();this.nt=function(){return function(b,a,c){this.mc=b;this.metadata=a;this.data=c;this[b.Af]=a;this[b.ec]=c}}();this.Mk=function(){return function(b,
a){this.mc=b;this.key=a;this[b.bj]=a}}();this.XY=function(){return function(b,a,c,h){this.mc=b;this.fetchParameters=a;this.results=c;this.done=h;this[b.$m]=a;this[b.jn]=c;this[b.Zm]=h}}();this.JC=function(){return function(b,a,c){this.mc=b;this.size=a;this.sortCriteria=c;this[b.oi]=a;this[b.qf]=c}}();this.xDa=function(){return function(b,a,c){this.mc=b;this.Ba=a;this.direction=c;this[b.eD]=a;this[b.jD]=c}}();this.EC=function(){return function(b,a,c,h){this.mc=b;this.add=a;this.remove=c;this.update=
h;this[b.SZ]=a;this[b.b0]=c;this[b.z0]=h}}();this.zO=function(){return function(b,a,c,h,k){this.mc=b;this.keys=a;this.metadata=c;this.data=h;this.indexes=k;this[b.Nc]=a;this[b.Af]=c;this[b.ec]=h;this[b.hw]=k}}();this.PY=function(){return function(b,a,c,h,k,g){this.mc=b;this.keys=a;this.metadata=h;this.data=k;this.indexes=g;this[b.Nc]=a;this[b.TZ]=c;this[b.Af]=h;this[b.ec]=k;this[b.hw]=g}}();this.hIa(b);this[this.Jh]=0}c.prototype.containsKeys=function(b){var a=this,c=[];b[this.Nc].forEach(function(b){c.push(a.ue.get(b))});
return Promise.all(c).then(function(c){var e=new Set;c.map(function(b){e.add(b[a.bj])});return Promise.resolve(new a.rH(a,b,e))})};c.prototype.fetchByKeys=function(b){var a=this,c=[];b[this.Nc].forEach(function(b){c.push(a.ue.get(b))});return Promise.all(c).then(function(c){var e=new Map;c.map(function(b){var c=b[a.bj];b=b[a.ec];e.set(c,new a.nt(a,new a.Mk(a,c),b))});return Promise.resolve(new a.IC(a,b,e))})};c.prototype.fetchByOffset=function(b){var a=this,c=null!=b?0<b[this.Jh]?b[this.Jh]:0:0,f=
new this.JC(this,null!=b?b[this.oi]:-1,null!=b?b[this.qf]:null),f=this.Sla(f,c),c=f[this.Nj],f=f[this.Zm],h=c[this.ec],k=c[this.Af].map(function(b){return b[a.bj]}),c=h.map(function(b,c){return new a.nt(a,b,k[c])});return Promise.resolve(new this.XY(this,b,c,f))};c.prototype.fetchFirst=function(b){this.Vr()||(this.oa=0);return new this.Mv(this,new this.Nv(this,this.Sla(b),b))};c.prototype.getCapability=function(b){return b==this.eQ&&"full"==this.ue.getCapability(b)?{attributes:"multiple"}:null};c.prototype.getTotalSize=
function(){return Promise.resolve(this.ue.totalSize())};c.prototype.Yd=function(){return 0<this.ue.totalSize()?"no":"yes"};c.prototype.getPage=function(){return this.Vr()?this.ue.getPage():-1};c.prototype.setPage=function(b,a){return this.Vr()?this.ue.setPage(b,a):Promise.reject(null)};c.prototype.getStartItemIndex=function(){return this.Vr()?this.ue.getStartItemIndex():-1};c.prototype.getEndItemIndex=function(){return this.Vr()?this.ue.getEndItemIndex():-1};c.prototype.getPageCount=function(){return this.Vr()?
this.ue.getPageCount():-1};c.prototype.totalSize=function(){return this.Vr()?this.ue.totalSize():-1};c.prototype.totalSizeConfidence=function(){return this.Vr()?this.ue.totalSizeConfidence():null};c.prototype.Sla=function(b,a){var c=this;if(null!=b&&null!=b[this.qf]){var f=b[this.qf][0][this.eD],h=b[this.qf][0][this.jD];this.xoa=!0;this.Vr()||(this.oa=0);return function(b,f){return function(h,g){if(g){var t={};t[c.bj]=b;t[c.jD]=f;c[c.Jh]=0;return c.ue.sort(t).then(function(){c.xoa=!1;return c.s4(a)(h)})}return c.s4(a)(h)}}(f,
h)}return this.s4(a)};c.prototype.s4=function(b){var a=this;return function(c){var f={};b=0<b?b:0;null!=a.oa&&(f[a.vI]=a.oa+b);f[a.Q_]=null!=c&&0<c[a.oi]?c[a.oi]:null;a.Vr()||(f[a.LGa]=!0);if(null!=a.ue[a.qf]&&null==c[a.qf]){c[a.qf]=[];var h=new a.xDa(a,a.ue[a.qf][a.bj],a.ue[a.qf][a.jD]);c[a.qf].push(h)}f[a.cfa]=c[a.cfa];a.uu=!0;return new Promise(function(b,h){a.to=b;a.Pka=h;a.O2=c;a.vx||a.ue.fetch(f).then(function(h){if(null!==h){a.uu=!1;void 0===h&&(h={},h[a.Nc]=[],h[a.ec]=[]);var g=[];null!=h[a.Nc]&&
(g=h[a.Nc].map(function(b){return new a.Mk(a,b)}));null==a.oa&&(a.oa=0);var l=!1;a.oa+=h[a.ec].length;"actual"==a.ue.totalSizeConfidence()&&0<a.ue.totalSize()&&a.oa>=a.ue.totalSize()?l=!0:0<f[a.Q_]&&h[a.ec].length<f[a.Q_]?l=!0:0==h[a.ec].length&&(l=!0);a.to=null;a.O2=null;b(new a.Ov(a,new a.Sv(a,c,h[a.ec],g),l))}},function(b){h(b)})})}};c.prototype.hIa=function(b){var c=this;b.on("sync",function(b){c.oa=null;0<b[c.vI]&&(c.oa=b[c.vI],c[c.Jh]=c.oa);if(c.to&&null!=b[c.Nc]){c.uu=!1;var f=b[c.Nc].map(function(b){return new c.Mk(c,
b)}),h=!1;"actual"==c.ue.totalSizeConfidence()&&0<c.ue.totalSize()&&c.oa>=c.ue.totalSize()&&(h=!0);c.to(new c.Ov(c,new c.Sv(c,c.O2,b[c.ec],f),h));c.to=null;c.O2=null}else c.vx||c.dispatchEvent(new a.FC);c.vx=!1});b.on("add",function(b){var f=b[c.Nc].map(function(b){return new c.Mk(c,b)}),h=new Set;b[c.Nc].map(function(b){h.add(b)});b=new c.PY(c,h,null,f,b[c.ec],b[c.hw]);b=new c.EC(c,b,null,null);c.dispatchEvent(new a.tH(b))});b.on("remove",function(b){var f=b[c.Nc].map(function(b){return new c.Mk(c,
b)}),h=new Set;b[c.Nc].map(function(b){h.add(b)});b=new c.zO(c,h,f,b[c.ec],b[c.hw]);b=new c.EC(c,null,b,null);c.dispatchEvent(new a.tH(b))});b.on("reset",function(){c.vx||(c.oa=0,c.dispatchEvent(new a.FC))});b.on(this.eQ,function(){c.xoa||(c.oa=null,c.dispatchEvent(new a.FC))});b.on("change",function(b){var f=b[c.Nc].map(function(b){return new c.Mk(c,b)}),h=new Set;b[c.Nc].map(function(b){h.add(b)});b=new c.zO(c,h,f,b[c.ec],b[c.hw]);b=new c.EC(c,null,null,b);c.dispatchEvent(new a.tH(b))});b.on(this.a0,
function(b){c.uu||c.vx||(c.oa=null!=b[c.Jh]?b[c.Jh]:null,c.dispatchEvent(new a.FC));c.vx=!1});b.on("request",function(b){"undefined"!==typeof a.V&&b instanceof a.V||c.uu||(0<b[c.vI]&&0==c.getStartItemIndex()&&(c.oa=b[c.vI]),c.vx=!0,c.dispatchEvent(new a.FC))});b.on("error",function(b){c.Pka&&c.Pka(b);c.uu=!1;c.vx=!1});b.on("page",function(b){c.uu=!1;c.vx=!1;var f={};f.detail=b;c.dispatchEvent(new a.Kca(a.hi.ga.PAGE,f))})};c.prototype.Vr=function(){return null!=this.ue.getStartItemIndex?!0:!1};return c}();
a.UY.Lx(g);a.TableDataSourceAdapter=g;a.$C=g;a.f.j("TableDataSourceAdapter.prototype.containsKeys",{containsKeys:g.prototype.containsKeys});a.f.j("TableDataSourceAdapter.prototype.fetchByKeys",{fetchByKeys:g.prototype.fetchByKeys});a.f.j("TableDataSourceAdapter.prototype.fetchByOffset",{fetchByOffset:g.prototype.fetchByOffset});a.f.j("TableDataSourceAdapter.prototype.fetchFirst",{fetchFirst:g.prototype.fetchFirst});a.f.j("TableDataSourceAdapter.prototype.getCapability",{getCapability:g.prototype.getCapability});
a.f.j("TableDataSourceAdapter.prototype.getTotalSize",{getTotalSize:g.prototype.getTotalSize});a.f.j("TableDataSourceAdapter.prototype.isEmpty",{Yd:g.prototype.Yd})});