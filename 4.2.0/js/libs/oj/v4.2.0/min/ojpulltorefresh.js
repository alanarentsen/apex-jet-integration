/**
 * Copyright (c) 2014, 2018, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
define(["ojs/ojcore","jquery","promise","ojs/ojcomponentcore"],function(a,g){a.Jd={};o_("PullToRefreshUtils",a.Jd,a);a.Jd.V6a=function(c,b,d){var e,f,h,k,l,m,n,t,s,p,q,r,u,w;a.Jd.qBa(c);e=g(document.createElement("div")).addClass("oj-pulltorefresh-outer");a.Jd.yXa(c,e,b,d);f=g(document.createElement("div")).addClass("oj-pulltorefresh-panel");e.append(f);h=g(c);h.prepend(e);h.on("touchstart.pulltorefresh",function(b){null==g.data(f[0],"data-pullstart")&&0===h[0].scrollTop&&(a.Jd.aoa(b,f,d),s=f.find(".oj-pulltorefresh-icon"),
0<s.length&&(p=s.parent().outerHeight(!0)),d&&!isNaN(d.threshold)&&(l=parseInt(d.threshold,10)),l=isNaN(l)?f.outerHeight(!0):Math.max(0,Math.min(l,f.outerHeight(!0))),f.css("height",0),f.removeClass("oj-pulltorefresh-transition"),g.data(f[0],"data-pullstart",b.originalEvent.touches[0].clientY),g.data(f[0],"data-pullstart-horiz",b.originalEvent.touches[0].clientX),k=!0)}).on("touchmove.pulltorefresh",function(b){m=g.data(f[0],"data-pullstart");if(null!=m&&(n=b.originalEvent.touches[0].clientY-parseInt(m,
10),!(0>n)&&(b.preventDefault(),null==g.data(f[0],"data-closing"))))if(null!=g.data(f[0],"data-loading"))f.css("height",Math.max(n,l));else{if(k&&(k=!1,t=b.originalEvent.touches[0].clientX-parseInt(g.data(f[0],"data-pullstart-horiz"),10),Math.abs(t)>n))return;f.css("height",n);a.Jd.hA(b,"pull",f,n);null!=s&&0<s.length&&(q=g.data(f[0],"data-lasticonclass"),null!=q&&s.removeClass(q),u=10*Math.round(n/l*10),100<=u?(w="oj-pulltorefresh-icon-full",r=a.Aa.T("oj-pullToRefresh.titleIconFull")):(w="oj-pulltorefresh-icon-"+
u+"-percent",r=a.Aa.T("oj-pullToRefresh.titleIcon"+u+"percent")),s.addClass(w),s.attr("title",r),g.data(f[0],"data-lasticonclass",w),a.Jd.GZa(f,n>p))}}).on("touchcancel.pulltorefresh",function(){a.Jd.Gp(f)}).on("touchend.pulltorefresh",function(d){m=g.data(f[0],"data-pullstart");null!=m&&null==g.data(f[0],"data-closing")&&(null!=g.data(f[0],"data-loading")?(n=g.data(f[0],"data-panelheight"),f.css("height",n)):f.outerHeight()<l?(f.addClass("oj-pulltorefresh-transition").css("height",0),a.Jd.Gp(f)):
a.Jd.boa(d,c,f,b))})};o_("PullToRefreshUtils.setupPullToRefresh",a.Jd.V6a,a);a.Jd.aoa=function(c,b,d){var e,f;a.Jd.hA(c,"pull",b,0);0==b.children().length&&(d&&(e=d.primaryText,f=d.secondaryText),a.Jd.OKa(b,e,f));b.prev().text(a.Aa.T("oj-pullToRefresh.ariaRefreshingLink"));b.css("height","auto");g.data(b[0],"data-panelheight",b.outerHeight())};a.Jd.boa=function(c,b,d,e){var f,h,k,l;f=g.data(d[0],"data-panelheight");d.addClass("oj-pulltorefresh-transition").css("height",f);a.Jd.hA(c,"release",d,f);
g.data(d[0],"data-loading",!0);h=d.find(".oj-pulltorefresh-icon");0<h.length&&(k=g.data(d[0],"data-lasticonclass"),null!=k&&h.removeClass(k),h.addClass("oj-pulltorefresh-icon-full"));h=a.Context.getContext(b).Dc().Xc({description:"PullToRefresh:handleRelease"});g.data(g(b)[0],"data-pulltorefresh-busystate",h);e().then(function(){l=function(){a.Jd.hA(c,"complete",d,f);a.Jd.Gp(d);d.off("transitionend",l);d.prev().text("");a.Jd.Cf(b)};d.prev().text(a.Aa.T("oj-pullToRefresh.ariaRefreshCompleteLink"));
d.prev().prev().css("position","");g.data(d[0],"data-closing",!0);d.on("transitionend",l);d.css("height",0)},function(){l=function(){a.Jd.Gp(d);d.off("transitionend",l);d.prev().text("");a.Jd.Cf(b)};d.prev().prev().css("position","");g.data(d[0],"data-closing",!0);d.on("transitionend",l);d.css("height",0)})};a.Jd.qBa=function(c){g(c).children(".oj-pulltorefresh-outer").remove();g(c).off(".pulltorefresh");a.Jd.Cf(c)};o_("PullToRefreshUtils.tearDownPullToRefresh",a.Jd.qBa,a);a.Jd.Cf=function(a){var b;
a=g(a)[0];if(b=g.data(a,"data-pulltorefresh-busystate"))b(null),g.removeData(a,"data-pulltorefresh-busystate")};a.Jd.hA=function(a,b,d,e){b=g.Event("oj"+b);b.originalEvent=a;d.trigger(b,{content:d,distance:e})};a.Jd.OKa=function(a,b,d){var e,f;a.addClass("oj-pulltorefresh-content").attr("aria-hidden","true");e=g(document.createElement("div"));e.addClass("oj-icon oj-pulltorefresh-icon oj-pulltorefresh-icon-initial");f=g(document.createElement("div"));f.addClass("oj-pulltorefresh-icon-container");f.append(e);
g.data(a[0],"data-lasticonclass","oj-pulltorefresh-icon-initial");a.append(f);null!=b&&(b=g(document.createElement("div")).addClass("oj-pulltorefresh-primary-text").text(b),a.append(b),null!=d&&(d=g(document.createElement("div")).addClass("oj-pulltorefresh-secondary-text").text(d),a.append(d)))};a.Jd.GZa=function(a,b){var d,e;d=a.find(".oj-pulltorefresh-primary-text");e=a.find(".oj-pulltorefresh-secondary-text");b?(d&&d.show(),e&&e.show()):(d&&d.hide(),e&&e.hide())};a.Jd.yXa=function(c,b,d,e){var f,
h,k;f=g(document.createElement("a"));f.text(a.Aa.T("oj-pullToRefresh.ariaRefreshLink"));f.addClass("oj-helper-hidden-accessible").attr("href","#").focus(function(){f.css("position","static")}).blur(function(a){null!=a.relatedTarget&&f.css("position","")}).click(function(f){h=b.children().last();a.Jd.aoa(f,h,e);a.Jd.boa(f,c,h,d);d()});k=g(document.createElement("div"));k.addClass("oj-helper-hidden-accessible").attr("aria-live","polite");b.append(f);b.append(k)};a.Jd.Gp=function(a){g.removeData(a[0],
"data-pullstart");g.removeData(a[0],"data-pullstart-horiz");g.removeData(a[0],"data-loading");g.removeData(a[0],"data-closing");0<a.find(".oj-pulltorefresh-icon").length&&a.empty()}});