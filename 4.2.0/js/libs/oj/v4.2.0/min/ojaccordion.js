/**
 * Copyright (c) 2014, 2018, Oracle and/or its affiliates.
 * The Universal Permissive License (UPL), Version 1.0
 */
"use strict";
/*
 Copyright 2013 jQuery Foundation and other contributors
 Released under the MIT license.
 http://jquery.org/license
*/
define(["ojs/ojcore","jquery","ojs/ojcomponentcore","ojs/ojcollapsible"],function(a,g){(function(){a.ib("oj.ojAccordion",g.oj.baseComponent,{widgetEventPrefix:"oj",options:{multiple:!1,expanded:null,beforeExpand:null,expand:null,beforeCollapse:null,collapse:null},rc:function(){this._super();this.element.addClass("oj-accordion oj-component").attr("role","group");this.options.expanded=this.Dka(this.options.expanded);this.qg()},li:function(a,b,d){this.mi(b,d,{launcher:this.element.find(".oj-collapsible-header-icon").first()})},
_destroy:function(){this.element.removeClass("oj-accordion oj-component").removeAttr("role");this.element.children().removeClass("oj-accordion-collapsible");this.element.children(".oj-accordion-created").removeClass("oj-accordion-created").ojCollapsible("destroy")},_setOption:function(a,b,d){if("multiple"===a)!1==b&&!0==this.options.multiple&&this.element.children(".oj-expanded").first().siblings(".oj-collapsible").ojCollapsible("collapse",!1);else if("expanded"===a){this.Xsa(b);return}this._super(a,
b,d)},refresh:function(){this._super();this.qg()},qg:function(){this.wUa();this.Woa=!0;this.Xsa(this.options.expanded);this.Woa=!1;this.aq()},wUa:function(){this.In=this.element.children();this.$()?(this.element.children("oj-collapsible").each(function(a,b){b.setAttribute("expand-area","header")}),this.In.not("oj-collapsible").ojCollapsible({expandArea:"header"}).addClass("oj-accordion-created").attr("data-oj-internal","")):(this.element.children(":oj-collapsible").each(function(){g(this).ojCollapsible("option",
"expandArea","header")}),this.In.not(":oj-ojCollapsible").ojCollapsible({expandArea:"header"}).addClass("oj-accordion-created").attr("data-oj-internal",""));this.In.addClass("oj-accordion-collapsible")},aq:function(){var a;a=this.$()?{keydown:this.jx,ojBeforeExpand:this.Wha,ojExpand:this.Cka,ojBeforeCollapse:this.Vha,ojCollapse:this.Via}:{keydown:this.jx,ojbeforeexpand:this.Wha,ojexpand:this.Cka,ojbeforecollapse:this.Vha,ojcollapse:this.Via};this._off(this.In);this._on(this.In,a)},jx:function(a){if(!a.altKey&&
!a.ctrlKey&&(g(a.target).hasClass("oj-collapsible-header")||g(a.target).hasClass("oj-collapsible-header-icon"))){var b=g.ui.keyCode,d=this.In.not(".oj-disabled"),e=d.length,f=g(a.target).closest(".oj-collapsible"),h=d.index(f),k=!1;if(0<=h)switch(a.keyCode){case b.RIGHT:case b.DOWN:k=d[(h+1)%e];break;case b.LEFT:case b.UP:k=d[(h-1+e)%e];break;case b.HOME:k=d[0];break;case b.END:k=d[e-1]}k&&(f&&g(f).trigger("ojfocusout"),g(k).trigger("ojfocus"),a.preventDefault())}},V2:function(a){return!this.options.multiple&&
(a=g(a.target).closest(".oj-collapsible"),a.parent().is(":oj-ojAccordion"))?a.siblings(".oj-collapsible.oj-expanded").map(function(){return g(this).data("oj-ojCollapsible")}):g()},Wha:function(a,b){if(!this.FT(a))return!0;this.eE=g(a.target);var d,e=null;this.V2(a).each(function(){e=this.element;var b={header:e.find(".oj-collapsible-header"),content:e.find(".oj-collapsible-content")};d=this._trigger("beforeCollapse",a,b);d||(this.eE=null);return d});this.options.multiple||(d=this._trigger("beforeExpand",
a,this.BK(e,this.eE)));var f=this;d&&this.V2(a).each(function(){this.collapse(!1,a,b);f.P1=this.widget()});return d},Cka:function(a,b){var d=null;this.P1&&(d=this.P1,this.P1=null);if(this.FT(a)&&!this.F2){var e,f=this;this.V2(a).each(function(){this.collapse(!1,a,b);e=f.BK(this.element,g(a.target))});e||(e=f.BK(d,g(a.target)));this.options.multiple||this._trigger("expand",a,e);this.c9();this.eE=null}},Vha:function(a,b){return this.FT(a)&&!this.options.multiple?(!b&&a.originalEvent instanceof CustomEvent&&
(b=a.originalEvent.detail),this._trigger("beforeCollapse",a,this.Coa(a,b))):!0},Via:function(a,b){if(!this.F2&&this.FT(a)){!b&&a.originalEvent instanceof CustomEvent&&(b=a.originalEvent.detail);var d=this.Coa(a,b);this.options.multiple||this._trigger("collapse",a,d);this.c9()}},BK:function(a,b){return{fromCollapsible:a,toCollapsible:b}},Coa:function(a,b){var d;b.toCollapsible?d=b:a.originalEvent&&a.originalEvent.target&&(d=this.BK(g(a.target),this.eE));!d&&this.eE&&(d=this.BK(g(a.target),this.eE));
return d},FT:function(a){return g(a.target).is(this.In)},c9:function(){var c,b=[],d,e=0;this.In.each(function(a){var h=!1;if(h="oj-collapsible"===this.tagName.toLowerCase()?"true"===this.getAttribute("expanded"):g(this).ojCollapsible("option","expanded"))d={},(c=g(this).attr("id"))&&(d.id=c),d.index=a,b.push(d),e++});a.f.Wia(b,this.options.expanded)||this.option("expanded",b,{_context:{Sa:!0,Rc:!0}})},Dka:function(a){if(Array.isArray(a)){for(var b,d=[],e=[],f=0;f<a.length;f++){var h=a[f];"number"===
typeof h||"string"===typeof h?e.push(h):"number"===typeof h.index?e.push(h.index):"string"===typeof h.id&&e.push(h.id)}this.element.children().each(function(a){(b=g(this).attr("id"))?-1==e.indexOf(b)&&-1==e.indexOf(a)||d.push({id:b,index:a}):-1!=e.indexOf(a)&&d.push({index:a})});!this.options.multiple&&1<d.length&&(d=[d[d.length-1]]);return d}return null},Xsa:function(c){this.Woa||(c=this.Dka(c));if(c){var b=this,d,e,f,h,k=0;this.In.each(function(l){d=g(this);e=d.attr("id");f=!1;if(h=c[k])e?e==h.id&&
(f=!0):l==h.index&&(f=!0),f&&k++;var m="oj-collapsible"===this.tagName.toLowerCase();(m?"true"==this.getAttribute("expanded")||""==this.getAttribute("expanded"):d.ojCollapsible("option","expanded"))!==f&&(a.D.warn("JET Accordion: override collapsible "+l+" expanded setting"),b.F2=!0,m?this.setAttribute("expanded",f):d.ojCollapsible("option","expanded",f),b.F2=!1)})}this.c9()},getNodeBySubId:function(a){if(null==a)return this.element?this.element[0]:null;var b=a.subId;a=a.index;if("number"!==typeof a||
0>a||a>=this.In.length)return null;a=this.In[a];switch(b){case "oj-accordion-content":b="oj-collapsible-content";break;case "oj-accordion-header":b="oj-collapsible-header";break;case "oj-accordion-disclosure":case "oj-accordion-header-icon":b="oj-collapsible-disclosure";break;case "oj-accordion-collapsible":return a;default:return null}return g(a).ojCollapsible("getNodeBySubId",{subId:b})},getSubIdByNode:function(a){for(var b=-1,d=a;d;){b=Array.prototype.indexOf.call(this.In,d);if(-1!=b)break;d=d.parentElement}d=
null;if(-1!=b)switch(a=(a=g(this.In[b]).ojCollapsible("getSubIdByNode",a))?a:{},a.subId){case "oj-collapsible-content":d="oj-accordion-content";break;case "oj-collapsible-header":d="oj-accordion-header";break;case "oj-collapsible-disclosure":case "oj-collapsible-header-icon":d="oj-accordion-disclosure";break;default:d="oj-accordion-collapsible"}return d?{subId:d,index:b}:null},Pl:function(c,b,d){return"expanded"==c?a.f.Bb(b,d):this._super(c,b,d)}})})();a.J.Ua("oj-accordion","baseComponent",{properties:{expanded:{type:"Array",
writeback:!0},multiple:{type:"boolean"}},events:{beforeCollapse:{},beforeExpand:{},collapse:{},expand:{}},extension:{Ya:"ojAccordion"}});a.J.register("oj-accordion",{metadata:a.J.getMetadata("oj-accordion")})});